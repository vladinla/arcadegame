function ScoreBoard(){this.init();}ScoreBoard.HEIGHT=48;ScoreBoard.TITLE_TEXT_Y=17;ScoreBoard.LIVES_POSITION_X=5;ScoreBoard.LIVES_POSITION_Y=-6;ScoreBoard.SCORE_POSITION_X=500;ScoreBoard.SCORE_POSITION_Y=60;ScoreBoard.TITLE_FONT='20px Luckiest Guy';ScoreBoard.SCORE_FONT='40px Luckiest Guy';ScoreBoard.BANNER_MSG_FONT='25px Luckiest Guy';ScoreBoard.prototype.init=function(){this.sprite='images/char-boy.png';this.reset();};ScoreBoard.prototype.reset=function(){this.remainingLives=GameBoard.LIVES_PER_GAME;this.bannerMessage=null;this.score=0;this.points=0;};ScoreBoard.prototype.addLife=function(){this.remainingLives++;};ScoreBoard.prototype.removeLife=function(){this.remainingLives--;};ScoreBoard.prototype.addPoints=function(points){this.points+=points;};ScoreBoard.prototype.setSprite=function(sprite){this.sprite=sprite;};ScoreBoard.prototype.setBannerMessage=function(message){this.bannerMessage=message;};ScoreBoard.prototype.update=function(){if(gameBoard.paused){return;}this.score+=this.points;};ScoreBoard.prototype.render=function(){ctx.fillStyle='#ffd800';ctx.fillRect(0,0,GameBoard.TILE_WIDTH*gameBoard.columns,topBuffer+ScoreBoard.HEIGHT);var image=Resources.get(this.sprite);var width=image.width*0.5;var height=image.height*0.5;for(var i=0;i<this.remainingLives;++i){ctx.drawImage(image,ScoreBoard.LIVES_POSITION_X+i*width,ScoreBoard.LIVES_POSITION_Y,width,height);}ctx.fillStyle='black';ctx.font=ScoreBoard.TITLE_FONT;ctx.textAlign='left';ctx.fillText('Remaining Lives',ScoreBoard.LIVES_POSITION_X,ScoreBoard.TITLE_TEXT_Y);ctx.textAlign='right';ctx.fillText('Remaining Time / Score',ScoreBoard.SCORE_POSITION_X,ScoreBoard.TITLE_TEXT_Y);ctx.font=ScoreBoard.SCORE_FONT;if(gameBoard.gameMode){ctx.fillText(gameBoard.remainingTime+' / '+this.score,ScoreBoard.SCORE_POSITION_X,ScoreBoard.SCORE_POSITION_Y);}else{ctx.fillText(GameBoard.GAME_DURATION+' / 0',ScoreBoard.SCORE_POSITION_X,ScoreBoard.SCORE_POSITION_Y);}this.renderBannerMessage();this.points=0;};ScoreBoard.prototype.renderBannerMessage=function(){if(this.bannerMessage!==null){ctx.fillStyle='black';ctx.font=ScoreBoard.BANNER_MSG_FONT;ctx.textAlign='center';ctx.fillText(this.bannerMessage,GameBoard.TILE_WIDTH/2+gameBoard.getWidth()/2,GameBoard.TILE_HEIGHT/2+gameBoard.getHeight());}};function GameBoard(rows,columns){this.rows=rows;this.columns=columns;this.stopwatch=new Stopwatch();this.firstRun=true;this.demoMode=false;this.showHelp=false;this.gameMode=false;this.paused=false;this.resumeGame=false;this.gameOver=false;this.soundOn=false;this.sounds={collision:'sounds/hit.wav',charmdrop:'sounds/pop.wav',charmpickup:'sounds/thud.wav'};this.reset();}GameBoard.LIVES_PER_GAME=4;GameBoard.TILE_WIDTH=101;GameBoard.TILE_HEIGHT=83;GameBoard.TOP_ROW=0;GameBoard.POINTS_PER_SECOND=1000;GameBoard.GAME_DURATION=120;GameBoard.HELP_SCREENS=4;GameBoard.prototype.reset=function(){this.stopwatch.reset();this.remainingTime=GameBoard.GAME_DURATION;this.gameOver=false;this.paused=false;this.helpScreen=GameRulesDialog.ID;this.demoMode=this.firstRun;this.showHelp=this.firstRun;this.gameMode=!this.firstRun;if(this.firstRun){this.firstRun=false;}};GameBoard.prototype.update=function(){if(this.showHelp){this.showHelpScreen();}else{this.hideHelpScreens();}if(!this.paused){this.stopwatch.start();this.remainingTime=GameBoard.GAME_DURATION-this.stopwatch.seconds();}if(this.demoMode){gameOverDialog.visible=false;}else{if(this.paused){this.stopwatch.stop();}else{if(this.isGameOver()){this.paused=true;this.gameOver=true;this.resumeGame=false;gameOverDialog.show();}}}};GameBoard.prototype.isGameOver=function(){if(scoreBoard.remainingLives===0){gameOverDialog.setReason(GameOverDialog.OuttaLivesReason);return true;}if(this.remainingTime<=0){gameOverDialog.setReason(GameOverDialog.OuttaTimeReason);return true;}return false;};GameBoard.prototype.getSeconds=function(){return this.stopwatch.seconds();};GameBoard.prototype.getWidth=function(){return(this.columns-1)*GameBoard.TILE_WIDTH;};GameBoard.prototype.getHeight=function(){return(this.rows-1)*GameBoard.TILE_HEIGHT;};GameBoard.prototype.getRandomEnemyRow=function(){return GameBoard.Random(0,this.getBottomRow()-2);};GameBoard.prototype.getBottomRow=function(){return this.rows-1;};GameBoard.prototype.getRowFromY=function(y,offset){return(y-offset)/GameBoard.TILE_HEIGHT;};GameBoard.prototype.getYFromRow=function(row,offset){return(row*GameBoard.TILE_HEIGHT)+offset;};GameBoard.prototype.playSound=function(soundFile){if(gameBoard.soundOn){var sound=new Audio(soundFile);sound.play();}};GameBoard.prototype.startNewGame=function(){this.hideHelpScreens();gameOverDialog.hide();scoreBoard.reset();gameBoard.reset();player.reset();charmsManager.reset();for(var i=0;i<allEnemies.length;++i){allEnemies[i].init();}};GameBoard.prototype.startDemoMode=function(){this.startNewGame();this.gameMode=false;this.demoMode=true;this.showHelp=false;};GameBoard.Random=function(lowLimit,highLimit){return lowLimit+Math.floor(Math.random()*(highLimit-lowLimit+1));};GameBoard.prototype.handleInput=function(key){switch(key){case'debug':console.log("DemoMode="+this.demoMode+", GameMode="+this.gameMode+", GameOver="+this.gameOver+", paused="+this.paused+", showHelp="+this.showHelp+", resumeGame="+this.resumeGame);break;case'left':this.showPreviousHelpScreen();break;case'right':this.showNextHelpScreen();break;case'esc':if((this.demoMode&&this.showHelp)||(this.gameMode&&this.gameOver)){this.startDemoMode();scoreBoard.setBannerMessage('Hit the spacebar to play!');}break;case'space':if(this.demoMode||(this.gameMode&&this.gameOver)){this.startNewGame();}else if(this.resumeGame){this.showHelp=false;this.paused=false;this.resumeGame=false;}else{this.paused=!this.paused;}break;}};GameBoard.prototype.showPreviousHelpScreen=function(){if(this.showHelp){this.helpScreen--;if(this.helpScreen<0){this.helpScreen=GameBoard.HELP_SCREENS-1;}}};GameBoard.prototype.showNextHelpScreen=function(){if(this.showHelp){this.helpScreen++;if(this.helpScreen==GameBoard.HELP_SCREENS){this.helpScreen=0;}}};GameBoard.prototype.showHelpScreen=function(){gameOverDialog.hide();gameRulesDialog.visible=(this.helpScreen==GameRulesDialog.ID);hintsDialog.visible=(this.helpScreen==HintsDialog.ID);attributionDialog.visible=(this.helpScreen==AttributionDialog.ID);attributionSoundsDialog.visible=(this.helpScreen==AttributionSoundsDialog.ID);};GameBoard.prototype.hideHelpScreens=function(){gameRulesDialog.hide();hintsDialog.hide();attributionDialog.hide();attributionSoundsDialog.hide();};function RenderableItem(id,x,y,sprite){this.id=id;this.x=x;this.y=y;this.sprite=sprite;}RenderableItem.prototype.render=function(width,height){if(width==null&&height==null){ctx.drawImage(Resources.get(this.sprite),this.x,topBuffer+this.y);}else{ctx.drawImage(Resources.get(this.sprite),this.x,topBuffer+this.y,width,height);}};RenderableItem.prototype.setSprite=function(sprite){this.sprite=sprite;};function InteractiveItem(id,width,visibleWidth,startingXPosition,startingYPosition,sprite){RenderableItem.call(this,id,startingXPosition,startingYPosition,sprite);this.row=0;this.startingXPosition=startingXPosition;this.startingYPosition=startingYPosition;this.width=width;this.halfVisibleWidth=visibleWidth/2;}InteractiveItem.prototype=Object.create(RenderableItem.prototype);InteractiveItem.prototype.constructor=InteractiveItem;InteractiveItem.prototype.leftX=function(){return this.x+(this.width/2)-this.halfVisibleWidth;};InteractiveItem.prototype.rightX=function(){return this.x+(this.width/2)+this.halfVisibleWidth;};InteractiveItem.prototype.overlapsWith=function(other){return((other instanceof InteractiveItem)&&(this.row==other.row)&&(this.leftX()<other.rightX())&&(this.rightX()>other.leftX()));};function Enemy(id){var width=101;var visibleWidth=101;var startingXPosition=-GameBoard.TILE_WIDTH;var startingYPosition=0;InteractiveItem.call(this,id,width,visibleWidth,startingXPosition,startingYPosition,'images/enemy-red.png');this.info=[{sprite:'images/enemy-green.png',color:'green',charm:'images/charm-green.png',points:Enemy.KILL_POINTS_GREEN},{sprite:'images/enemy-blue.png',color:'blue',charm:'images/charm-blue.png',points:Enemy.KILL_POINTS_BLUE},{sprite:'images/enemy-yellow.png',color:'yellow',charm:'images/charm-yellow.png',points:Enemy.KILL_POINTS_YELLOW},{sprite:'images/enemy-purple.png',color:'purple',charm:'images/charm-purple.png',points:Enemy.KILL_POINTS_PURPLE},{sprite:'images/enemy-red.png',color:'red',charm:'images/charm-red.png',points:Enemy.KILL_POINTS_RED}];this.init();}Enemy.prototype=Object.create(InteractiveItem.prototype);Enemy.prototype.constructor=Enemy;Enemy.HIT_FROM_BEHIND_BIAS=5;Enemy.ZOMBIE_LIFETIME=100;Enemy.MIN_DELAY=0;Enemy.MaxDelay=100;Enemy.MIN_SPEED=75;Enemy.MAX_SPEED=300;Enemy.OFFSET_Y=-18;Enemy.KILL_POINTS_GREEN=2000;Enemy.KILL_POINTS_BLUE=4000;Enemy.KILL_POINTS_YELLOW=6000;Enemy.KILL_POINTS_PURPLE=8000;Enemy.KILL_POINTS_RED=10000;Enemy.COLUMN_TOLERANCE=GameBoard.TILE_WIDTH*0.1;Enemy.prototype.init=function(){this.row=gameBoard.getRandomEnemyRow();this.x=this.startingXPosition;this.y=gameBoard.getYFromRow(this.row,Enemy.OFFSET_Y);this.delay=GameBoard.Random(Enemy.MIN_DELAY,Enemy.MaxDelay);this.speed=GameBoard.Random(Enemy.MIN_SPEED,Enemy.MAX_SPEED);this.index=this.getIndex();this.sprite=this.info[this.index].sprite;this.zombieCounter=Enemy.ZOMBIE_LIFETIME;this.zombie=false;};Enemy.prototype.render=function(){if(this.zombie){ctx.globalAlpha=this.zombieCounter/Enemy.ZOMBIE_LIFETIME;InteractiveItem.prototype.render.call(this);ctx.globalAlpha=1;if(!gameBoard.paused&&this.zombieCounter>0){this.zombieCounter--;}}else{InteractiveItem.prototype.render.call(this);}};Enemy.prototype.getCharmSprite=function(){return this.info[this.index].charm;};Enemy.prototype.getIndex=function(){if(this.speed<120)return 0;if(this.speed<165)return 1;if(this.speed<210)return 2;if(this.speed<255)return 3;return 4;};Enemy.prototype.leftX=function(){return this.x+(this.width/2)-this.halfVisibleWidth+Enemy.HIT_FROM_BEHIND_BIAS;};Enemy.prototype.centeredInTile=function(){if(this.x<=0){return false;}if(this.x>=(gameBoard.columns*GameBoard.TILE_WIDTH)){return false;}var tileCenter=GameBoard.TILE_WIDTH/2;var columnPosition=Math.floor(this.x%GameBoard.TILE_WIDTH);if(columnPosition<=(tileCenter-Enemy.COLUMN_TOLERANCE)||columnPosition>=(tileCenter+Enemy.COLUMN_TOLERANCE)){return false;}return true;};Enemy.prototype.update=function(dt){if(gameBoard.paused){return;}if(this.delay>0){this.delay--;}else{this.x+=(this.speed*dt);if(this.x>ctx.canvas.width||this.zombieCounter===0){this.init();}}};function Player(id){var width=101;var visibleWidth=60;var startingXPosition=gameBoard.getWidth()/2;var startingYPosition=gameBoard.getHeight()+Player.OFFSET_Y;InteractiveItem.call(this,id,width,visibleWidth,startingXPosition,startingYPosition,Player.DEFAULT_SPRITE);this.init();}Player.prototype=Object.create(InteractiveItem.prototype);Player.prototype.constructor=Player;Player.OFFSET_Y=-8;Player.DEFAULT_SPRITE='images/char-boy.png';Player.prototype.init=function(){this.info=[{sprite:'images/char-cat-girl.png'},{sprite:'images/char-pink-girl.png'},{sprite:'images/char-princess-girl.png'},{sprite:'images/char-horn-girl.png'},{sprite:'images/char-boy.png'}];this.index=this.info.length-1;this.reset();};Player.prototype.reset=function(){this.lastSecond=gameBoard.getSeconds();this.row=gameBoard.getBottomRow();this.x=this.startingXPosition;this.y=this.startingYPosition;};Player.prototype.update=function(){if(gameBoard.paused){return;}this.detectEnemyCollisions();this.detectCharmPickups();var currentSeconds=gameBoard.getSeconds();if(this.IsActive()&&currentSeconds>this.lastSecond){scoreBoard.addPoints(GameBoard.POINTS_PER_SECOND);this.lastSecond=currentSeconds;}};Player.prototype.detectEnemyCollisions=function(){for(var i=0;i<allEnemies.length;++i){var enemy=allEnemies[i];if(!enemy.zombie&&this.overlapsWith(enemy)){if(this.index!=enemy.index){scoreBoard.removeLife();gameBoard.playSound(gameBoard.sounds.collision);this.reset();break;}else{if(!enemy.zombie){enemy.zombie=true;scoreBoard.addPoints(enemy.info[enemy.index].points);}}}}};Player.prototype.detectCharmPickups=function(){for(var i=0;i<charmsManager.charms.length;++i){var charm=charmsManager.charms[i];if(charm.visible&&this.overlapsWith(charm)){charm.pickup();}}};Player.prototype.handleInput=function(key,ctrlKey){if(ctrlKey&&key==='up'){this.setNextSprite();}else if(ctrlKey&&key==='down'){this.setPreviousSprite();}else if(gameBoard.gameMode&&!gameBoard.paused){if(key==='left'){this.moveLeft();}else if(key==='right'){this.moveRight();}else if(key==='up'){this.moveUp();}else if(key==='down'){this.moveDown();}}};Player.prototype.moveLeft=function(){if(this.x>=GameBoard.TILE_WIDTH){this.x-=GameBoard.TILE_WIDTH;}};Player.prototype.moveRight=function(){if((this.x+GameBoard.TILE_WIDTH)<ctx.canvas.width){this.x+=GameBoard.TILE_WIDTH;}};Player.prototype.moveUp=function(){if(this.row>GameBoard.TOP_ROW){this.row--;this.y-=GameBoard.TILE_HEIGHT;}};Player.prototype.moveDown=function(){if(this.row<gameBoard.getBottomRow()){this.row++;this.y+=GameBoard.TILE_HEIGHT;}};Player.prototype.setNextSprite=function(){this.index++;if(this.index>(this.info.length-1)){this.index=0;}this.setSprite(this.info[this.index].sprite);scoreBoard.setSprite(this.info[this.index].sprite);};Player.prototype.setPreviousSprite=function(){this.index--;if(this.index<0){this.index=this.info.length-1;}this.setSprite(this.info[this.index].sprite);scoreBoard.setSprite(this.info[this.index].sprite);};Player.prototype.IsActive=function(){return(this.row<=(gameBoard.getBottomRow()-2));};function Charm(id,points){InteractiveItem.call(this,id,Charm.WIDTH*0.25,Charm.VISIBLE_WIDTH,0,0,null);this.points=(points==null?Charm.DEFAULT_POINTS:points);this.counter=Charm.LIFETIME;this.visible=false;}Charm.prototype=Object.create(InteractiveItem.prototype);Charm.prototype.constructor=Charm;Charm.WIDTH=101;Charm.HEIGHT=171;Charm.VISIBLE_WIDTH=20;Charm.OFFSET_Y=100;Charm.DEFAULT_POINTS=5000;Charm.LIFETIME=2000;Charm.prototype.render=function(width,height){if(this.visible){ctx.globalAlpha=this.counter>Charm.LIFETIME/10?1:this.counter/(Charm.LIFETIME/10);InteractiveItem.prototype.render.call(this,width,height);ctx.globalAlpha=1;if(!gameBoard.paused){if(this.counter>0){this.counter--;}else{this.visible=false;}}}};Charm.prototype.drop=function(){for(var i=0;i<allEnemies.length;++i){var enemy=allEnemies[i];if(enemy.centeredInTile()){this.x=enemy.x;this.y=enemy.y+Charm.OFFSET_Y;this.y+=GameBoard.Random(0,20)*-GameBoard.Random(0,1);this.row=gameBoard.getRowFromY(enemy.y,Enemy.OFFSET_Y);this.sprite=enemy.getCharmSprite();this.visible=true;this.counter=Charm.LIFETIME;gameBoard.playSound(gameBoard.sounds.charmdrop);return true;}}return false;};Charm.prototype.pickup=function(){gameBoard.playSound(gameBoard.sounds.charmpickup);scoreBoard.addPoints(this.points);charmsManager.resetCharmTimer();this.visible=false;};function CharmsManager(){this.charms=[new Charm(0),new Charm(1),new Charm(2),new Charm(3),new Charm(4),new Charm(5)];this.resetCharmTimer();}CharmsManager.MIN_DELAY=2;CharmsManager.MAX_DELAY=4;CharmsManager.prototype.reset=function(){this.resetCharmTimer();for(var i=0;i<this.charms.length;++i){this.charms[i].visible=false;}};CharmsManager.prototype.resetCharmTimer=function(){this.seconds=0;this.startingSeconds=gameBoard.getSeconds();this.delay=GameBoard.Random(CharmsManager.MIN_DELAY,CharmsManager.MAX_DELAY);};CharmsManager.prototype.render=function(){this.charms.forEach(function(charm){if(charm.visible){var width=Charm.WIDTH*0.25;var height=Charm.HEIGHT*0.25;charm.render(width,height);}});};CharmsManager.prototype.update=function(){if(gameBoard.paused){return;}this.seconds=gameBoard.getSeconds()-this.startingSeconds;if(this.seconds>=this.delay){for(var i=0;i<this.charms.length;++i){var charm=this.charms[i];if(!charm.visible&&charm.drop()){this.resetCharmTimer();break;}}}};function Stopwatch(){this.reset();}Stopwatch.prototype.start=function(){this.startTime=this.startTime?this.startTime:Date.now();};Stopwatch.prototype.stop=function(){this.elapsedTime=this.startTime?this.elapsedTime+(Date.now()-this.startTime):this.elapsedTime;this.startTime=0;};Stopwatch.prototype.reset=function(){this.startTime=0;this.elapsedTime=0;};Stopwatch.prototype.seconds=function(){var ms=this.elapsedTime+(this.startTime?Date.now()-this.startTime:0);return Math.floor(ms/1000);};function Dialog(){this.init();}Dialog.LEFT_MARGIN=GameBoard.TILE_WIDTH/2;Dialog.TITLE_FONT='64px Luckiest Guy';Dialog.NORMAL_FONT='25px Luckiest Guy';Dialog.SMALL_FONT='20px Luckiest Guy';Dialog.BULLET=String.fromCodePoint(0x2022);Dialog.LEFT_ICON=String.fromCodePoint(0x2039);Dialog.RIGHT_ICON=String.fromCodePoint(0x203A);Dialog.ALPHA=0.83;Dialog.prototype.init=function(x,y,width,height,radius){this.width=width||(GameBoard.TILE_WIDTH*gameBoard.columns);this.height=height||(GameBoard.TILE_HEIGHT*gameBoard.rows+bottomBuffer);this.x=x||0;this.y=y||(topBuffer+ScoreBoard.HEIGHT);this.radius=radius||0;this.leftX=this.x+Dialog.LEFT_MARGIN;this.midX=this.x+(this.width/2);this.visible=false;};Dialog.prototype.render=function(){if(this.visible){this.drawDialog(this.x,this.y,this.width,this.height,this.radius,true,true);this.contents();}};Dialog.prototype.show=function(){this.visible=true;};Dialog.prototype.hide=function(){this.visible=false;};Dialog.prototype.titleText=function(title,x,y){ctx.fillStyle='red';ctx.textAlign='center';ctx.font=Dialog.TITLE_FONT;ctx.fillText(title,x,y);};Dialog.prototype.startResumeGameText=function(y,again){again=again||false;ctx.textAlign='center';ctx.fillText('Hit the space bar',this.midX,y+=45);ctx.fillText('to'+(gameBoard.resumeGame?' resume ':' ')+'play'+(again?' again ':' ')+'...',this.midX,y+=27);};Dialog.prototype.drawDialog=function(x,y,width,height,radius,fill,stroke,alpha,color){if(typeof stroke=='undefined'){stroke=true;}if(typeof radius==='undefined'){radius=5;}ctx.fillStyle=color||'black';ctx.globalAlpha=alpha||Dialog.ALPHA;ctx.beginPath();ctx.moveTo(x+radius,y);ctx.lineTo(x+width-radius,y);ctx.quadraticCurveTo(x+width,y,x+width,y+radius);ctx.lineTo(x+width,y+height-radius);ctx.quadraticCurveTo(x+width,y+height,x+width-radius,y+height);ctx.lineTo(x+radius,y+height);ctx.quadraticCurveTo(x,y+height,x,y+height-radius);ctx.lineTo(x,y+radius);ctx.quadraticCurveTo(x,y,x+radius,y);ctx.closePath();if(stroke){ctx.stroke();}if(fill){ctx.fill();}ctx.globalAlpha=1.0;};function GameRulesDialog(){this.init();}GameRulesDialog.prototype=Object.create(Dialog.prototype);GameRulesDialog.prototype.constructor=GameRulesDialog;GameRulesDialog.ID=0;GameRulesDialog.prototype.contents=function(){var y=this.y+70;this.titleText('Game Rules '+Dialog.RIGHT_ICON,this.midX,y);ctx.font=Dialog.NORMAL_FONT;ctx.textAlign='left';ctx.fillText(Dialog.BULLET+' Move the Player using the',this.leftX,y+=40);ctx.fillText('   arrow keys: up, down, left, right',this.leftX,y+=27);ctx.fillText(Dialog.BULLET+' Avoid the ladybugs!',this.leftX,y+=34);ctx.fillText(Dialog.BULLET+' Get points for each second',this.leftX,y+=34);ctx.fillText('   the player is in-play (the grass',this.leftX,y+=27);ctx.fillText('   area is NOT considered in-play)',this.leftX,y+=27);ctx.fillText(Dialog.BULLET+' Get points for cleaning up',this.leftX,y+=34);ctx.fillText('   after the ladybugs',this.leftX,y+=27);ctx.fillText(Dialog.BULLET+' Game is over when all lives',this.leftX,y+=34);ctx.fillText('   are used or the time is up',this.leftX,y+=27);ctx.fillText(Dialog.BULLET+' Ctrl-up/down changes player',this.leftX,y+=34);this.startResumeGameText(gameBoard.getHeight()+GameBoard.TILE_HEIGHT);};function HintsDialog(){this.init();}HintsDialog.prototype=Object.create(Dialog.prototype);HintsDialog.prototype.constructor=HintsDialog;HintsDialog.ID=1;HintsDialog.prototype.contents=function(){var y=this.y+70;this.titleText(Dialog.LEFT_ICON+' Game Hints '+Dialog.RIGHT_ICON,this.midX,y);ctx.font=Dialog.NORMAL_FONT;ctx.textAlign='left';ctx.fillText(Dialog.BULLET+' Change players during play to',this.leftX,y+=40);ctx.fillText('   reveal each characters power',this.leftX,y+=27);ctx.fillText('   to defeat certain enemies',this.leftX,y+=27);ctx.fillText(Dialog.BULLET+' Play wisely! Points for ...',this.leftX,y+=34);ctx.fillText('   Cleaning up after ladybugs - '+Charm.DEFAULT_POINTS,this.leftX,y+=30);ctx.fillText('   Each full second in play - '+GameBoard.POINTS_PER_SECOND,this.leftX,y+=30);ctx.fillText('   Defeating Green Enemy - '+Enemy.KILL_POINTS_GREEN,this.leftX,y+=30);ctx.fillText('   Defeating Blue Enemy - '+Enemy.KILL_POINTS_BLUE,this.leftX,y+=30);ctx.fillText('   Defeating Yellow Enemy - '+Enemy.KILL_POINTS_YELLOW,this.leftX,y+=30);ctx.fillText('   Defeating Purple Enemy - '+Enemy.KILL_POINTS_PURPLE,this.leftX,y+=30);ctx.fillText('   Defeating Red Enemy - '+Enemy.KILL_POINTS_RED,this.leftX,y+=30);this.startResumeGameText(gameBoard.getHeight()+GameBoard.TILE_HEIGHT);};function AttributionDialog(){this.init();}AttributionDialog.prototype=Object.create(Dialog.prototype);AttributionDialog.prototype.constructor=AttributionDialog;AttributionDialog.ID=2;AttributionDialog.prototype.contents=function(){var y=this.y+70;this.titleText(Dialog.LEFT_ICON+' Attribution'+Dialog.RIGHT_ICON,this.midX,y);ctx.font=Dialog.NORMAL_FONT;ctx.textAlign='left';ctx.fillText(Dialog.BULLET+' Original Artwork design by',this.leftX,y+=40);ctx.fillText('   Daniel Cook (Lostgarden.com)',this.leftX,y+=27);ctx.fillText('   Stone & Grass Tiles',this.leftX,y+=27);ctx.fillText('   Red Enemy & Red Player',this.leftX,y+=27);ctx.fillText('   Green, Blue & Yellow Players',this.leftX,y+=27);ctx.fillText(Dialog.BULLET+' Additional colors for Enemies',this.leftX,y+=34);ctx.fillText('   by Cheryl Court (cherylcourt.ca)',this.leftX,y+=27);ctx.fillText('   Green, Blue, Yellow & Purple',this.leftX,y+=27);ctx.fillText(Dialog.BULLET+' Artwork by David Mumford',this.leftX,y+=34);ctx.fillText('   All Ladybug Charms',this.leftX,y+=27);ctx.fillText('   Modifications to Purple Player',this.leftX,y+=27);this.startResumeGameText(gameBoard.getHeight()+GameBoard.TILE_HEIGHT);};function AttributionSoundsDialog(){this.init();}AttributionSoundsDialog.prototype=Object.create(Dialog.prototype);AttributionSoundsDialog.prototype.constructor=AttributionSoundsDialog;AttributionSoundsDialog.ID=3;AttributionSoundsDialog.prototype.contents=function(){var y=this.y+70;this.titleText(Dialog.LEFT_ICON+' Attribution',this.midX,y);ctx.font=Dialog.NORMAL_FONT;ctx.textAlign='left';ctx.fillText(Dialog.BULLET+' All sounds obtained from',this.leftX,y+=40);ctx.fillText('   freesound.org - CC BY 3.0 License',this.leftX,y+=27);ctx.fillText(Dialog.BULLET+' Enemy/Player Collisions',this.leftX,y+=34);ctx.fillText('   By Leviclasssen, hit_002.wav.',this.leftX,y+=27);ctx.fillText(Dialog.BULLET+' Ladybug Charm drops',this.leftX,y+=34);ctx.fillText('    By Yottasounds, pop.wav.',this.leftX,y+=27);ctx.fillText(Dialog.BULLET+' Ladybug Charm pickups',this.leftX,y+=34);ctx.fillText('    By EdgardEdition, thud6.wav.',this.leftX,y+=27);ctx.fillText(Dialog.BULLET+' Luckiest Guy Font by Brian J.',this.leftX,y+=34);ctx.fillText('    Bonislawsky. Available under',this.leftX,y+=27);ctx.fillText('    the Apache 2.0 License',this.leftX,y+=27);this.startResumeGameText(gameBoard.getHeight()+GameBoard.TILE_HEIGHT);};function GameOverDialog(){var x=GameBoard.TILE_WIDTH/2;var y=gameBoard.getHeight()/4;var width=gameBoard.getWidth();var height=gameBoard.getHeight()/2;var radius=15;this.init(x,y,width,height,radius);this.reason=null;}GameOverDialog.prototype=Object.create(Dialog.prototype);GameOverDialog.prototype.constructor=GameOverDialog;GameOverDialog.OuttaTimeReason='Time';GameOverDialog.OuttaLivesReason='Lives';GameOverDialog.prototype.setReason=function(reason){this.reason=reason;};GameOverDialog.prototype.contents=function(){var y=this.y+75;this.titleText('Game Over!',this.midX,y);if(this.reason!==null){y+=30;ctx.font=Dialog.SMALL_FONT;ctx.fillText('(Outta '+this.reason+')',this.midX,y);}ctx.font=Dialog.NORMAL_FONT;this.startResumeGameText(y,true);};function showGameInfo(){if(gameBoard.demoMode){gameBoard.showHelp=true;scoreBoard.bannerMessage=null;}else if(gameBoard.gameMode&&(gameBoard.paused||gameBoard.gameOver)){gameBoard.showHelp=true;gameBoard.resumeGame=!gameBoard.gameOver;}}function toggleSound(){gameBoard.soundOn=!gameBoard.soundOn;document.getElementById('sound').innerHTML=gameBoard.soundOn?'Sound On':'Sound Off';}var scoreBoard=new ScoreBoard();var gameBoard=new GameBoard(6,5);var gameRulesDialog=new GameRulesDialog();var hintsDialog=new HintsDialog();var attributionDialog=new AttributionDialog();var attributionSoundsDialog=new AttributionSoundsDialog();var gameOverDialog=new GameOverDialog();var allEnemies=[new Enemy(0),new Enemy(1),new Enemy(2),new Enemy(3),new Enemy(4),new Enemy(5)];var player=new Player(0);var charmsManager=new CharmsManager();document.addEventListener('keydown',function(e){e=e||window.event;var allowedKeys={27:'esc',32:'space',37:'left',38:'up',39:'right',40:'down',68:'debug'};gameBoard.handleInput(allowedKeys[e.keyCode]);player.handleInput(allowedKeys[e.keyCode],e.ctrlKey);});